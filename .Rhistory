<<<<<<< HEAD
#power dataframe for non-parametric
power_data <- data.frame('FACES' = numeric(length(m)), 'AKS' = numeric(length(m)),
'FES' = numeric(length(m)), 'SCS' = numeric(length(m)),
'FPPS' = numeric(length(m)), 'SEAS' = numeric(length(m)))
#power dataframe for parametric group
power_norm <- data.frame('FACES' = numeric(length(m)), 'AKS' = numeric(length(m)),
'FES' = numeric(length(m)), 'SCS' = numeric(length(m)),
'FPPS' = numeric(length(m)), 'SEAS' = numeric(length(m)))
for (n in m) {
# Number of times to bootstrap
B <- 1e4
#survey categories
surveys <- as.character(unique(faces$Survey))
#dataframe to hold simulation results
test <- data.frame('FACES' = numeric(B), 'AKS' = numeric(B), 'FES' = numeric(B),
'SCS' = numeric(B), 'FPPS' = numeric(B), 'SEAS' = numeric(B))
control <- data.frame('FACES' = numeric(B), 'AKS' = numeric(B), 'FES' = numeric(B),
'SCS' = numeric(B), 'FPPS' = numeric(B), 'SEAS' = numeric(B))
for (j in 1:6) {
sample_faces_test <- faces %>%
filter(Time == 'Post',
Group == 'Experimental',
Survey == surveys[j]) %>%
group_by(`Participant #`) %>%
summarise(Total = sum(Response)) %>%
ungroup()
sample_faces_control <- faces %>%
filter(Time == 'Post',
Group == 'Control',
Survey == surveys[j]) %>%
group_by(`Participant #`) %>%
summarise(Total = sum(Response)) %>%
ungroup()
# Vector to store means
m1d <- numeric()
m1n <- numeric()
#pre sample mean and sd
test_mean <- mean(sample_faces_test$Total)
test_sd <- sd(sample_faces_test$Total)
for (i in 1:B) {
dist <- sample(sample_faces_test$Total, size = n, replace = T)
m1d[i] <- mean(dist)
dist <- rnorm(n, mean=test_mean, sd=test_sd)
m1n[i] <- mean(dist)
}
#vector to store post means
m2d <- numeric()
m2n <- numeric()
#post sample mean and sd
control_mean <- mean(sample_faces_control$Total)
control_sd <- sd(sample_faces_control$Total)
for (i in 1:B) {
dist <- sample(sample_faces_control$Total, size = (60-n), replace = T)
m2d[i] <- mean(dist)
dist <- rnorm((60-n), mean=control_mean, sd=control_sd)
m2n[i] <- mean(dist)
}
power_data[n / 5, j] <- mean(m2d < m1d)
power_norm[n / 5, j] <- mean(m2n < m1n)
}
}
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 14))
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 14))
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 14))
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number(scale = 0.01))
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number(scale = 0.01))
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number(scale = 0.01)) +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 14))
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number_format(scale = 0.01)) +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 14))
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number_format(scale = 0.1)) +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 14))
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number_format(scale = 1)) +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 14))
for (n in m) {
# Number of times to bootstrap
B <- 1e4
#survey categories
surveys <- as.character(unique(faces$Survey))
#dataframe to hold simulation results
test <- data.frame('FACES' = numeric(B), 'AKS' = numeric(B), 'FES' = numeric(B),
'SCS' = numeric(B), 'FPPS' = numeric(B), 'SEAS' = numeric(B))
control <- data.frame('FACES' = numeric(B), 'AKS' = numeric(B), 'FES' = numeric(B),
'SCS' = numeric(B), 'FPPS' = numeric(B), 'SEAS' = numeric(B))
for (j in 1:6) {
sample_faces_test <- faces %>%
filter(Time == 'Post',
Group == 'Experimental',
Survey == surveys[j]) %>%
group_by(`Participant #`) %>%
summarise(Total = sum(Response)) %>%
ungroup()
sample_faces_control <- faces %>%
filter(Time == 'Post',
Group == 'Control',
Survey == surveys[j]) %>%
group_by(`Participant #`) %>%
summarise(Total = sum(Response)) %>%
ungroup()
# Vector to store means
m1d <- numeric()
m1n <- numeric()
#pre sample mean and sd
test_mean <- mean(sample_faces_test$Total)
test_sd <- sd(sample_faces_test$Total)
for (i in 1:B) {
dist <- sample(sample_faces_test$Total, size = n, replace = T)
m1d[i] <- mean(dist)
dist <- rnorm(n, mean=test_mean, sd=test_sd)
m1n[i] <- mean(dist)
}
#vector to store post means
m2d <- numeric()
m2n <- numeric()
#post sample mean and sd
control_mean <- mean(sample_faces_control$Total)
control_sd <- sd(sample_faces_control$Total)
for (i in 1:B) {
dist <- sample(sample_faces_control$Total, size = (60-n), replace = T)
m2d[i] <- mean(dist)
dist <- rnorm((60-n), mean=control_mean, sd=control_sd)
m2n[i] <- mean(dist)
}
power_data[n / 5, j] <- mean(m2d < m1d)
power_norm[n / 5, j] <- mean(m2n < m1n)
}
}
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number_format(scale = 1)) +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 14))
ggsave('Post Survey Power Calcs.png', width = 16, height = 9, units = 'in')
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number_format(scale = 1)) +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 16))
ggsave('Post Survey Power Calcs.png', width = 16, height = 9, units = 'in')
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number_format(scale = 1)) +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 18))
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=55, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
scale_y_continuous(labels = scales::number_format(scale = 1)) +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations - Post Survey Results: Experimental vs Control",
caption = 'Control Group Sample Size = 60 - Experimental Group Sample Size') +
theme(text = element_text(size = 26))
ggsave('Post Survey Power Calcs.png', width = 16, height = 9, units = 'in')
library(tidyverse)
theme_set(theme_bw())
faces <- read_csv('../../Data/cleaned_FACES_data.csv', col_types = c('ffffdf'))
#how many different n to test
m <- seq(from=5, to=60, by=5)
#power dataframe for non-parametric
power_data <- data.frame('FACES' = numeric(length(m)), 'AKS' = numeric(length(m)),
'FES' = numeric(length(m)), 'SCS' = numeric(length(m)),
'FPPS' = numeric(length(m)), 'SEAS' = numeric(length(m)))
#power dataframe for parametric group
power_norm <- data.frame('FACES' = numeric(length(m)), 'AKS' = numeric(length(m)),
'FES' = numeric(length(m)), 'SCS' = numeric(length(m)),
'FPPS' = numeric(length(m)), 'SEAS' = numeric(length(m)))
for (n in m) {
# Number of times to bootstrap
B <- 1e4
#survey categories
surveys <- as.character(unique(faces$Survey))
#dataframe to hold simulation results
pre.exp <- data.frame('FACES' = numeric(B), 'AKS' = numeric(B), 'FES' = numeric(B),
'SCS' = numeric(B), 'FPPS' = numeric(B), 'SEAS' = numeric(B))
post.exp <- data.frame('FACES' = numeric(B), 'AKS' = numeric(B), 'FES' = numeric(B),
'SCS' = numeric(B), 'FPPS' = numeric(B), 'SEAS' = numeric(B))
for (j in 1:6) {
sample_faces_pre <- faces %>%
filter(Time == 'Pre',
Group == 'Experimental',
Survey == surveys[j]) %>%
group_by(`Participant #`) %>%
summarise(Total = sum(Response)) %>%
ungroup()
sample_faces_post <- faces %>%
filter(Time == 'Post',
Group == 'Experimental',
Survey == surveys[j]) %>%
group_by(`Participant #`) %>%
summarise(Total = sum(Response)) %>%
ungroup()
# Vector to store means
m1d <- numeric()
m1n <- numeric()
#pre sample mean and sd
pre_mean <- mean(sample_faces_pre$Total)
pre_sd <- sd(sample_faces_pre$Total)
for (i in 1:B) {
dist <- sample(sample_faces_pre$Total, size = n, replace = T)
m1d[i] <- mean(dist)
dist <- rnorm(n, mean=pre_mean, sd=pre_sd)
m1n[i] <- mean(dist)
}
#vector to store post means
m2d <- numeric()
m2n <- numeric()
#post sample mean and sd
post_mean <- mean(sample_faces_post$Total)
post_sd <- sd(sample_faces_post$Total)
for (i in 1:B) {
dist <- sample(sample_faces_post$Total, size = n, replace = T)
m2d[i] <- mean(dist)
dist <- rnorm(n, mean=post_mean, sd=post_sd)
m2n[i] <- mean(dist)
}
power_data[n / 5, j] <- mean(m2d > m1d)
power_norm[n / 5, j] <- mean(m2n > m1n)
}
}
#combine the data frames and change the column names
power <- cbind(power_data, power_norm)
colNames <- c('FACESd', 'AKSd', 'FESd', 'SCSd', 'FPPSd', 'SEASd',
'FACESn', 'AKSn', 'FESn', 'SCSn', 'FPPSn', 'SEASn')
colnames(power) <- colNames
#add indexing for the graph
power$ExpN <- m
power$ControlN <- seq(from=60, to=5, by=-5)
power %>%
select(ExpN, ends_with('d')) %>%
pivot_longer(-ExpN, names_to = 'Survey', values_to = 'Proportion True') %>%
mutate(Survey = str_replace(Survey, 'd', ''),
Survey = factor(Survey)) %>%
ggplot(aes(x = ExpN)) +
geom_line(aes(y = `Proportion True`, color = Survey),
size = 1, alpha = .75) +
facet_wrap(Survey ~., scales = 'free_y') +
labs(x = "Experimental Group Sample Size",
title = "Power Calculations for Pre versus Post Experimental Group") +
theme(text = element_text(size = 26))
ggsave('Pre vs Post Experimental Power Calcs.png', width = 16, height = 9, units = 'in')
rank
rank_sum
x2 <- c(3, 4, -5, 1)
x1 <- c(1, 2, 3, -4)
sum(x1)
sum(x2)
x1 - x2
sign(-1)
sign(-11)
sort(x1 - x2)
diff <- (x1 - x2)
sort(abs(diff))
data.frame(x1 = x1,
x2 = x2,
d  = x1 - x2)
data.frame(x1 = x1,
x2 = x2,
d  = x1 - x2,
s  = sign(d))
data.frame(x1 = x1,
x2 = x2,
d  = x1 - x2,
s  = sign(x1 - x2))
df <- data.frame(x1 = x1,
x2 = x2,
d  = x1 - x2,
s  = sign(x1 - x2))
df
arrange(df, abs(d))
arrange(df, abs(d)) %>%
mutate(rank = c(1.5, 1.5, 3, 4))
arrange(df, abs(d)) %>%
mutate(rank = c(1.5, 1.5, 3, 4)) %>%
mutate(sr   = rank * s)
df_test <- arrange(df, abs(d)) %>%
mutate(rank = c(1.5, 1.5, 3, 4)) %>%
mutate(sr   = rank * s)
df_test$sr %>% sum()
df_test$sr %>% sum() / (1+2+3+4)
wilcox.test(x1, x2)
wilcox.test(x1, x2, paired = T)
w_test <- wilcox.test(x1, x2, paired = T)
w_test$statistic
df_test
w_test <- wilcox.test(x2, x1, paired = T)
w_test$statistic
df <- data.frame(x1 = x1,
x2 = x2,
d  = x2 - x1,
s  = sign(x2 - x1))
df_test <- arrange(df, abs(d)) %>%
mutate(rank = c(1.5, 1.5, 3, 4)) %>%
mutate(sr   = rank * s)
df_test
w_test <- wilcox.test(x1, x2, paired = T)
w_test$statistic
w_test
=======
geom_hline(yintercept = 134, size=1, color = "black") +
geom_text(aes(0,134,label = "Mean of Pre",vjust = -1), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(yintercept = 134, size=1, color = "black") +
geom_text(aes(0,134,label = "Mean of Pre",vjust = 3), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(yintercept = 134, size=1, color = "black") +
geom_text(aes(1,134,label = "Mean of Pre",vjust = -1), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(yintercept = 134, size=1, color = "black") +
geom_text(aes(1,134,label = "Mean of Pre"), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(yintercept = 134, size=1, color = "black") +
geom_text(aes(1,134,label = "Mean of Pre",vjust = 1), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = 134, linetype = "Mean of Pre"), size=1, color = "black") +
geom_text(aes(1,134,label = "Mean of Pre",vjust = 1), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = 134, linetype = "Mean of Pre"), size=1, color = "black") +
geom_text(position = position_dodge(width = .75))
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = 134, linetype = "Mean of Pre"), size=1, color = "black") +
geom_text(aes(label =""), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = 134, linetype = "Mean of Pre"), size=1, color = "green") +
geom_text(aes(label =""), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = 134, linetype = "Mean of Pre"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = 134, linetype = "Mean of Pre"), size=1, color = "orange", linetype = "dashed") +
geom_text(aes(label =""), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPost$Mean[1], linetype = "Mean of Pre"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75))
meanPreValues<-meanPre$Mean[1]
meanPreValues
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, linetype = "Mean of Pre"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, key = "Mean of Pre"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, linetype = "Mean of Pre"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, linetype = "Mean of Pre"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .9))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, linetype = "Mean of Pre"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75))
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, linetype = "Mean of Pre"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, linetype = "Mean of Pre"), size=1, color = "yellow") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, linetype = "Mean of Pre"), size=1, color = "green") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPreValues, linetype = "Mean of Pre"), size=1, color = "green") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(filename = 'FES_Experimental_post_vs_pre.png', width = 16, height = 9, units = 'in')
dev.off()
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
meanPre<-extractmeanPre$Mean[1]
extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
meanPost<-extractmeanPost$Mean[1]
meanPre
meanPost
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
medianPre
medianPost
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
meanPre<-extractmeanPre$Mean[1]
extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
category_Exp
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
meanPre<-extractmeanPre$Mean[1]
extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPre, linetype = "Mean of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = meanPost, linetype = "Mean of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Mean Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("green", "orange")))) +
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
meanPre<-extractmeanPre$Mean[1]
extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = meanPre, linetype = "Mean of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = meanPost, linetype = "Mean of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Mean Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
library(tidyverse)
faces <- read_csv("C:/Users/17739/Desktop/ST 542 Statistical Practice/FinalProject/FACES/Data/cleaned_FACES_data.csv")
faces_tbl <- faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question)))
faces_tbl$`Participant #`<- as.factor(faces_tbl$`Participant #`) #used factor instead of character to preserve order
setwd("C:/Users/17739/Desktop/ST 542 Statistical Practice/FinalProject/FACES/Documents/Script_Documents/Visuals/SNW")
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle("FES Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(filename = 'FES_Experimental_post_vs_pre.png', width = 16, height = 9, units = 'in')
dev.off()
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle("Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = '_Experimental_post_vs_pre.png', width = 16, height = 9, units = 'in')
dev.off()
}
createBarPlot(FES)
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle(paste0(survey,"Scores - Experimental Group (Pre vs Post)")) +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = '_Experimental_post_vs_pre.png', width = 16, height = 9, units = 'in')
dev.off()
}
createBarPlot(FES)
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle(paste(survey," Scores - Experimental Group (Pre vs Post)")) +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = '_Experimental_post_vs_pre.png', width = 16, height = 9, units = 'in')
dev.off()
}
createBarPlot(FES)
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle( paste(survey, " Scores - Experimental Group (Pre vs Post)")) +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = '_Experimental_post_vs_pre.png', width = 16, height = 9, units = 'in')
dev.off()
}
createBarPlot(FES)
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle(" Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = paste0(survey,'_Experimental_post_vs_pre.png'), width = 16, height = 9, units = 'in')
dev.off()
}
createBarPlot(FES)
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey=="FES", Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle(" Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = paste0(survey,"_Experimental_post_vs_pre.png"), width = 16, height = 9, units = 'in')
dev.off()
}
createBarPlot(FES)
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey==survey, Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle(" Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = paste0(survey,"_Experimental_post_vs_pre.png"), width = 16, height = 9, units = 'in')
dev.off()
}
createBarPlot("FES")
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey==survey, Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle(" Scores - Experimental Group (Pre vs Post)") +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = paste0(survey,"_Experimental_post_vs_pre.png"), width = 16, height = 9, units = 'in')
}
createBarPlot("FES")
createBarPlot <- function(survey) {
category_Exp<-faces_tbl%>%filter(Survey==survey, Group=="Experimental")
#meanCalc<-category_Exp%>%group_by(Time)%>%summarise(Mean=mean(Total_Score))
#extractmeanPre<-meanCalc%>%filter(Time=="Pre")%>%select(Mean)
#meanPre<-extractmeanPre$Mean[1]
#extractmeanPost<-meanCalc%>%filter(Time=="Post")%>%select(Mean)
#meanPost<-extractmeanPost$Mean[1]
medianCalc<-category_Exp%>%group_by(Time)%>%summarise(Median=median(Total_Score))
extractmedianPre<-medianCalc%>%filter(Time=="Pre")%>%select(Median)
medianPre<-extractmedianPre$Median[1]
extractmedianPost<-medianCalc%>%filter(Time=="Post")%>%select(Median)
medianPost<-extractmedianPost$Median[1]
#category_Exp<-cbind(category_Exp,meanPre=meanPreValues,meanPost=meanPostValues)
ggplot(category_Exp, aes(x = `Participant #`,y = Total_Score, group = Time)) +
geom_col(position = "dodge",aes(fill=Time)) +
coord_flip() +
geom_hline(aes(yintercept = medianPre, linetype = "Median of Pre"), size=1, color = "green") +
geom_hline(aes(yintercept = medianPost, linetype = "Median of Post"), size=1, color = "orange") +
geom_text(aes(label =""), position = position_dodge(width = .75)) +
scale_linetype_manual(name = "Median Lines", values = c(2, 2),
guide = guide_legend(override.aes = list(color = c("orange", "green")))) +
ggtitle(paste(survey," Scores - Experimental Group (Pre vs Post)")) +
theme(plot.title = element_text(hjust = 0.5)) #to center title
ggsave(plot = last_plot(), filename = paste0(survey,"_Experimental_post_vs_pre.png"), width = 16, height = 9, units = 'in')
}
createBarPlot("FES")
>>>>>>> 25daff0bc1daafe0c71832489fdb092afb353a28
