ttestSample <- t(ttestSample)
colnames(ttestSample) <- surveys
ttestSample
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
faces_avg <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
faces <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_avg <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
#histograms of the faces pre data
surveys <- unique(faces_sum$Survey)
par(mfrow=c(2,2))
for (i in 1:2) {
hist((faces_avg %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
hist((faces_sum %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
}
par(mfrow=c(3,2))
for (i in 3:5) {
hist((faces_avg %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
hist((faces_sum %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
}
#histograms of the faces experimental data (diff between pre and post)
wider <- faces %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#Plot differences in histogram and qq plot
#we're hoping for roughly normal
diff <- wider$Post-wider$Pre
par(mfrow=c(1,1))
hist(diff,
main='Histogram of Differences Between Pre and Post',
breaks=10)
#Some normality issues in the upper tail. clearly a little bit right skewed
require(car)
qqp(diff)
#I think we can probably assume normality and ttests may not be outrageous either
#for now here is the power output
require(WMWssp)
sampleSize <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
sampleSize[i] <- WMWssp(temp$Pre, temp$Post, alpha = 0.05, power = 0.8)[6]
}
sampleSize <- t(sampleSize)
colnames(sampleSize) <- surveys
sampleSize
#calculate these for the t-test
require(pwr)
ttestSample <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
diff <- mean(temp$Post) - mean(temp$Pre)
poolVar <- ((sd(temp$Post)^2 + sd(temp$Pre)^2)/2)^0.5
ttestSample[i] <- pwr.t.test(d=diff/poolVar, power=0.80,
sig.level=0.05, type="paired", alternative='greater')[1]
}
ttestSample <- t(ttestSample)
colnames(ttestSample) <- surveys
ttestSample
## Loading data:
faces <- read_csv('../Data/cleaned_FACES_data.csv',
col_types = c('ffffdf'))
faces_avg <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
#Assuming the faces data is cleaned correctly. can be verified elswhere.
#starting w/ base faces data
prePostExp <- faces_sum %>%
filter(Group == 'Experimental') %>%
mutate(Survey = factor(Survey))
surveys <- unique(prePostExp$Survey)
pValppExp <- c()
for (i in 1:6) {
pValppExp[i] <- wilcox.test(avg_resp ~ Time,
paired = TRUE,
alternative="less",
data = filter(prePostExp, Survey == surveys[i]))[3]
}
pValppExp <- t(pValppExp)
colnames(pValppExp) <- surveys
pValppExp
prePostCon <- faces_sum %>%
filter(Group == 'Control') %>%
mutate(Survey = factor(Survey))
pValppCon <- c()
for (i in 1:6) {
pValppCon[i] <- wilcox.test(avg_resp ~ Time,
paired = TRUE,
alternative="less",
data = filter(prePostCon, Survey == surveys[i]))[3]
}
pValppCon <- t(pValppCon)
colnames(pValppCon) <- surveys
pValppCon
#-------------------------------
tcPre <- faces_sum %>%
filter(Time == 'Pre') %>%
mutate(Survey = factor(Survey), factor(Group))
pValTCPre <- c()
for (i in 1:6) {
pValTCPre[i] <- wilcox.test(avg_resp ~ Group,
paired = FALSE,
alternative="two.sided",
data = filter(tcPre, Survey == surveys[i]))[3]
}
pValTCPre <- t(pValTCPre)
colnames(pValTCPre) <- surveys
pValTCPre
tcPost <- faces_sum %>%
filter(Time == 'Post') %>%
mutate(Survey = factor(Survey), factor(Group))
pValTCPost <- c()
for (i in 1:6) {
pValTCPost[i] <- wilcox.test(avg_resp ~ Group,
paired = FALSE,
alternative="two.sided",
data = filter(tcPost, Survey == surveys[i]))[3]
}
pValTCPost <- t(pValTCPost)
colnames(pValTCPost) <- surveys
pValTCPost
faces_avg <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
#histograms of the faces pre data
surveys <- unique(faces_sum$Survey)
par(mfrow=c(2,2))
for (i in 1:2) {
hist((faces_avg %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
hist((faces_sum %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
}
par(mfrow=c(3,2))
for (i in 3:5) {
hist((faces_avg %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
hist((faces_sum %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
}
#histograms of the faces experimental data (diff between pre and post)
wider <- faces %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#Plot differences in histogram and qq plot
#we're hoping for roughly normal
diff <- wider$Post-wider$Pre
par(mfrow=c(1,1))
hist(diff,
main='Histogram of Differences Between Pre and Post',
breaks=10)
#Some normality issues in the upper tail. clearly a little bit right skewed
require(car)
qqp(diff)
#I think we can probably assume normality and ttests may not be outrageous either
#for now here is the power output
require(WMWssp)
sampleSize <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
sampleSize[i] <- WMWssp(temp$Pre, temp$Post, alpha = 0.05, power = 0.8)[6]
}
sampleSize <- t(sampleSize)
colnames(sampleSize) <- surveys
sampleSize
#calculate these for the t-test
require(pwr)
ttestSample <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
diff <- mean(temp$Post) - mean(temp$Pre)
poolVar <- ((sd(temp$Post)^2 + sd(temp$Pre)^2)/2)^0.5
ttestSample[i] <- pwr.t.test(d=diff/poolVar, power=0.80,
sig.level=0.05, type="paired", alternative='greater')[1]
}
ttestSample <- t(ttestSample)
colnames(ttestSample) <- surveys
ttestSample
#histograms of the faces experimental data (diff between pre and post)
wider <- faces %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
View(temp)
View(faces)
#histograms of the faces experimental data (diff between pre and post)
wider <- faces_sum %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
faces_avg <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
#histograms of the faces pre data
surveys <- unique(faces_sum$Survey)
par(mfrow=c(2,2))
for (i in 1:2) {
hist((faces_avg %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
hist((faces_sum %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
}
par(mfrow=c(3,2))
for (i in 3:5) {
hist((faces_avg %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
hist((faces_sum %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
}
#histograms of the faces experimental data (diff between pre and post)
wider <- faces_sum %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#Plot differences in histogram and qq plot
#we're hoping for roughly normal
diff <- wider$Post-wider$Pre
par(mfrow=c(1,1))
hist(diff,
main='Histogram of Differences Between Pre and Post',
breaks=10)
#Some normality issues in the upper tail. clearly a little bit right skewed
require(car)
qqp(diff)
#I think we can probably assume normality and ttests may not be outrageous either
#for now here is the power output
require(WMWssp)
sampleSize <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
sampleSize[i] <- WMWssp(temp$Pre, temp$Post, alpha = 0.05, power = 0.8)[6]
}
sampleSize <- t(sampleSize)
colnames(sampleSize) <- surveys
sampleSize
#calculate these for the t-test
require(pwr)
ttestSample <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
diff <- mean(temp$Post) - mean(temp$Pre)
poolVar <- ((sd(temp$Post)^2 + sd(temp$Pre)^2)/2)^0.5
ttestSample[i] <- pwr.t.test(d=diff/poolVar, power=0.80,
sig.level=0.05, type="paired", alternative='greater')[1]
}
ttestSample <- t(ttestSample)
colnames(ttestSample) <- surveys
ttestSample
surveys <- unique(faces_sum$Survey)
par(mfrow=c(2,2))
for (i in 1:2) {
hist((faces_avg %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
hist((faces_sum %>% filter(Time == 'Pre', Survey==surveys[i]))$avg_resp,
main=paste('Histogram for ', surveys[i]),
breaks=10
)
}
wider <- faces_sum %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#Plot differences in histogram and qq plot
#we're hoping for roughly normal
diff <- wider$Post-wider$Pre
par(mfrow=c(1,1))
hist(diff,
main='Histogram of Differences Between Pre and Post',
breaks=10)
View(faces_sum)
qqp(diff)
#I think we can probably assume normality and ttests may not be outrageous either
#for now here is the power output
require(WMWssp)
sampleSize <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
sampleSize[i] <- WMWssp(temp$Pre, temp$Post, alpha = 0.05, power = 0.8)[6]
}
sampleSize <- t(sampleSize)
colnames(sampleSize) <- surveys
sampleSize
ttestSample <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
diff <- mean(temp$Post) - mean(temp$Pre)
poolVar <- ((sd(temp$Post)^2 + sd(temp$Pre)^2)/2)^0.5
ttestSample[i] <- pwr.t.test(d=diff/poolVar, power=0.80,
sig.level=0.05, type="paired", alternative='greater')[1]
}
ttestSample <- t(ttestSample)
colnames(ttestSample) <- surveys
ttestSample
diff <- mean(wider$Post) - mean(wider$Pre)
poolVar <- ((sd(wider$Post)^2 + sd(wider$Pre)^2)/2)^0.5
pwr.t.test(d=diff/poolVar, power=0.80,
sig.level=0.05, type="paired", alternative='greater')[1]
ttestSample <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
diff <- mean(temp$Post) - mean(temp$Pre)
poolVar <- ((sd(temp$Post)^2 + sd(temp$Pre)^2)/2)^0.5
ttestSample[i] <- pwr.t.test(d=diff/poolVar, power=0.80,
sig.level=0.05, type="paired", alternative='greater')[1]
}
ttestSample <- t(ttestSample)
colnames(ttestSample) <- surveys
ttestSample
#histograms of the faces experimental data (diff between pre and post)
wider <- avg_resp %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#histograms of the faces experimental data (diff between pre and post)
wider <- faces_avg %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#Plot differences in histogram and qq plot
#we're hoping for roughly normal
diff <- wider$Post-wider$Pre
par(mfrow=c(1,1))
hist(diff,
main='Histogram of Differences Between Pre and Post',
breaks=10)
#Some normality issues in the upper tail. clearly a little bit right skewed
require(car)
qqp(diff)
require(pwr)
ttestSample <- c()
for (i in 1:6) {
temp <- wider %>% filter(Survey==surveys[i])
diff <- mean(temp$Post) - mean(temp$Pre)
poolVar <- ((sd(temp$Post)^2 + sd(temp$Pre)^2)/2)^0.5
ttestSample[i] <- pwr.t.test(d=diff/poolVar, power=0.80,
sig.level=0.05, type="paired", alternative='greater')[1]
}
ttestSample <- t(ttestSample)
colnames(ttestSample) <- surveys
ttestSample
View(temp)
faces_avg <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
#histograms of the faces experimental data (diff between pre and post)
wider_sum <- faces_sum %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#histograms of the faces experimental data (diff between pre and post)
wider_avg <- faces_avg %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
faces_avg <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
#histograms of the faces experimental data (diff between pre and post)
wider_sum <- faces_sum %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#histograms of the faces experimental data (diff between pre and post)
wider_avg <- faces_avg %>%
pivot_wider(id_cols = c('Participant #', 'Survey', 'Group'),
names_from = contains(c('Time')),
values_from = c(avg_resp)) %>%
filter(Group == 'Experimental')
#histograms of the faces pre data
surveys <- unique(faces_sum$Survey)
avgTest <- c()
sumTest <- c()
for (i in 1:6) {
temp <- wider_avg %>% filter(Survey==surveys[i])
avgTest[i] <- t.test(temp$Pre, temp$Post, paired=TRUE)
temp <- wider_sum %>% filter(Survey==surveys[i])
sumTest[i] <- t.test(temp$Pre, temp$Post, paired=TRUE)
}
avgTest <- t(avgTest)
sumTest <- t(sumTest)
colnames(avgTest) <- surveys
colnames(sumTest) <- surveys
avgTest
sumTest
t.test(temp$Pre, temp$Post, paired=TRUE)
t.test(temp$Pre, temp$Post, paired=TRUE)[3]
avgTest <- c()
sumTest <- c()
for (i in 1:6) {
temp <- wider_avg %>% filter(Survey==surveys[i])
avgTest[i] <- t.test(temp$Pre, temp$Post, paired=TRUE)[3]
temp <- wider_sum %>% filter(Survey==surveys[i])
sumTest[i] <- t.test(temp$Pre, temp$Post, paired=TRUE)[3]
}
avgTest <- t(avgTest)
sumTest <- t(sumTest)
colnames(avgTest) <- surveys
colnames(sumTest) <- surveys
avgTest
sumTest
View(wider_avg)
View(wider_sum)
faces_avg <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = mean(Response)) %>%
ungroup()
faces_sum <- faces %>%
group_by(Group, `Participant #`, Time, Survey) %>%
summarise(avg_resp = sum(Response)) %>%
ungroup()
#Assuming the faces data is cleaned correctly. can be verified elswhere.
#starting w/ base faces data
prePostExp <- faces_sum %>%
filter(Group == 'Experimental') %>%
mutate(Survey = factor(Survey))
surveys <- unique(prePostExp$Survey)
pValppExp <- c()
for (i in 1:6) {
pValppExp[i] <- wilcox.test(avg_resp ~ Time,
paired = TRUE,
alternative="less",
data = filter(prePostExp, Survey == surveys[i]))[3]
}
pValppExp <- t(pValppExp)
colnames(pValppExp) <- surveys
pValppExp
