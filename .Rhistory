throwers <- missing_sum %>%
distinct(`Participant #`, Group, Survey, .keep_all = T) %>% # added to removed Pre and Post
filter(missing_data > 2)
throwers <- missing_sum %>%
distinct(`Participant #`, Group, Survey, .keep_all = T) %>% # added to removed Pre and Post
filter(missing_data > 2)
throwers
(data_to_remove <- faces %>%
right_join(throwers, by = c('Participant #', 'Group', 'Survey'),
suffix = c('', '_mis')))
data_to_remove
dtr2 <- data_to_remove %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(removed_data = n())
missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group'))
missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>%
mutate(Impute = ifelse(is.na(removed_data), T, F))
missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>%
mutate(Impute = ifelse(is.na(removed_data), T, F),
removed_data = ifelse(is.na(removed_data), 0, removed_data)) %>%
select(`Participant #`, Group, Time, Survey,
`Missing Observations` = missing_data,
`Observations Removed` = removed_data)
missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>%
mutate(Impute = ifelse(is.na(removed_data), T, F),
removed_data = ifelse(is.na(removed_data), 0, removed_data)) %>%
select(`Participant #`, Group, Time, Survey,
`Missing Observations` = missing_data,
`Observations Removed` = removed_data) %>%
arrange(`Participant #`, Time, Survey)
missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>%
mutate(Impute = ifelse(is.na(removed_data), T, F),
removed_data = ifelse(is.na(removed_data), 0, removed_data)) %>%
select(`Participant #`, Group, Time, Survey,
`Missing Observations` = missing_data,
`Observations Removed` = removed_data) %>%
arrange(`Participant #`, desc(Time), Survey)
library(tidyverse)
source('Scripts/Data_Munging/FACES_fns.R')
faces <- format_FACES()
getwd()
source('../Data_Munging/FACES_fns.R')
faces <- format_FACES(path = 'Data/FACES_data_Spring_2019_AllData.csv')
faces <- format_FACES()
faces <- format_FACES(path = '../../Data/FACES_data_Spring_2019_AllData.csv')
missing_sum <- faces %>%
filter(is.na(Response)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(missing_data = sum(is.na(Response))) %>%
arrange(missing_data) %>%
ungroup()
throwers <- missing_sum %>%
distinct(`Participant #`, Group, Survey, .keep_all = T) %>% # added to removed Pre and Post
filter(missing_data > 2)
data_to_remove <- faces %>%
right_join(throwers, by = c('Participant #', 'Group', 'Survey'),
suffix = c('', '_mis'))
dtr2 <- data_to_remove %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(removed_data = n())
missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>%
mutate(Impute = ifelse(is.na(removed_data), T, F),
removed_data = ifelse(is.na(removed_data), 0, removed_data)) %>%
select(`Participant #`, Group, Time, Survey,
`Missing Observations` = missing_data,
`Observations Removed` = removed_data) %>%
arrange(`Participant #`, desc(Time), Survey)
missing_kable <- missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>%
mutate(Impute = ifelse(is.na(removed_data), T, F),
removed_data = ifelse(is.na(removed_data), 0, removed_data)) %>%
select(`Participant #`, Group, Time, Survey,
`Missing Observations` = missing_data,
`Observations Removed` = removed_data) %>%
arrange(`Participant #`, desc(Time), Survey)
throwers <- missing_sum %>%
distinct(`Participant #`, Survey, Group, .keep_all = T) %>% # added to removed Pre and Post
filter(missing_data > 2)
tribble(missing_kable,
'', '', '', 'Total', sum(missing_kable$`Missing Observations`), sum(missing_kable$`Observations Removed`))
add_row(missing_kable,
'', '', '', 'Total', sum(missing_kable$`Missing Observations`), sum(missing_kable$`Observations Removed`))
missing_kable
add_row(missing_kable,
'Participant #' = '',
'Group' = '',
'Time' = '',
'Survey' = 'Total',
'Missing Observations' = sum(missing_kable$`Missing Observations`),
'Observations Removed' = sum(missing_kable$`Observations Removed`))
add_row(missing_kable,
`Participant #` = '',
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`))
add_row(missing_kable,
`Participant #` = numeric(),
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`))
add_row(missing_kable,
`Participant #` = 1,
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`))
add_row(missing_kable,
`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`))
missing_kable <- missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>%
mutate(Impute = ifelse(is.na(removed_data), T, F),
removed_data = ifelse(is.na(removed_data), 0, removed_data)) %>%
select(`Participant #`, Group, Time, Survey,
`Missing Observations` = missing_data,
`Observations Removed` = removed_data) %>%
arrange(`Participant #`, Survey, desc(Time)) %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`))
knitr::kable(missing_kable)
dtr2
missing_sum
missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group'))
missing_kable <- missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>% mutate(bool = ifelse(missing_data == removed_data, T, F)) %>% View()
View(missing_sum)
obs <- faces %>%
filter(!is.na(Response)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(obs = n()) %>%
ungroup() %>%
pull(obs) %>%
sum()
obs
obs <- faces %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(obs = n()) %>%
ungroup() %>%
pull(obs) %>%
sum()
obs
missing_kable <- missing_kable %>%
add_row(`Participant #` = NA,
Group = c('', ''),
Time = c('', ''),
Survey = c('Total', 'Proportion'),
`Missing Observations` = c(sum(missing_kable$`Missing Observations`),
scales::percent(sum(missing_kable$`Missing Observations`)/obs)),
`Observations Removed` = c(sum(missing_kable$`Observations Removed`),
scales::percent(sum(missing_kable$`Observations Removed`)/obs)))
library(tidyverse)
source('../Data_Munging/FACES_fns.R')
faces <- format_FACES(path = '../../Data/FACES_data_Spring_2019_AllData.csv')
obs <- faces %>%
# filter(!is.na(Response)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(obs = n()) %>%
ungroup() %>%
pull(obs) %>%
sum()
missing_sum <- faces %>%
filter(is.na(Response)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(missing_data = sum(is.na(Response))) %>%
arrange(missing_data) %>%
ungroup()
throwers <- missing_sum %>%
distinct(`Participant #`, Group, Survey, .keep_all = T) %>% # added to removed Pre and Post
filter(missing_data > 2)
data_to_remove <- faces %>%
right_join(throwers, by = c('Participant #', 'Group', 'Survey'),
suffix = c('', '_mis'))
dtr2 <- data_to_remove %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(removed_data = n())
missing_kable <- missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>% mutate(bool = ifelse(missing_data == removed_data, T, F)) %>% View()
mutate(Impute = ifelse(is.na(removed_data), T, F),
removed_data = ifelse(is.na(removed_data), 0, removed_data)) %>%
select(`Participant #`, Group, Time, Survey,
`Missing Observations` = missing_data,
`Observations Removed` = removed_data) %>%
arrange(`Participant #`, Survey, desc(Time))
library(tidyverse)
source('../Data_Munging/FACES_fns.R')
faces <- format_FACES(path = '../../Data/FACES_data_Spring_2019_AllData.csv')
obs <- faces %>%
# filter(!is.na(Response)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(obs = n()) %>%
ungroup() %>%
pull(obs) %>%
sum()
missing_sum <- faces %>%
filter(is.na(Response)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(missing_data = sum(is.na(Response))) %>%
arrange(missing_data) %>%
ungroup()
throwers <- missing_sum %>%
distinct(`Participant #`, Group, Survey, .keep_all = T) %>% # added to removed Pre and Post
filter(missing_data > 2)
data_to_remove <- faces %>%
right_join(throwers, by = c('Participant #', 'Group', 'Survey'),
suffix = c('', '_mis'))
dtr2 <- data_to_remove %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(removed_data = n())
missing_kable <- missing_sum %>%
left_join(dtr2, by = c('Participant #', 'Time', 'Survey', 'Group')) %>%
mutate(Impute = ifelse(is.na(removed_data), T, F),
removed_data = ifelse(is.na(removed_data), 0, removed_data)) %>%
select(`Participant #`, Group, Time, Survey,
`Missing Observations` = missing_data,
`Observations Removed` = removed_data) %>%
arrange(`Participant #`, Survey, desc(Time))
missing_kable <- missing_kable %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`)) %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Proportion',
`Missing Observations` = scales::percent(sum(missing_kable$`Missing Observations`)/obs),
`Observations Removed` = scales::percent(sum(missing_kable$`Observations Removed`)/obs))
missing_kable <- missing_kable %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`))
missing_kable <- missing_kable %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`)) %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Proportion',
`Missing Observations` = scales::sum(missing_kable$`Missing Observations`)/obs,
`Observations Removed` = scales::sum(missing_kable$`Observations Removed`)/obs)
missing_kable <- missing_kable %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed`)) %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Proportion',
`Missing Observations` = sum(missing_kable$`Missing Observations`)/obs,
`Observations Removed` = sum(missing_kable$`Observations Removed`)/obs)
missing_kable %>%
knitr::kable()
missing_kable <- missing_kable %>%
add_row(`Participant #` = NA,
Group = '',
Time = '',
Survey = 'Total',
`Missing Observations` = sum(missing_kable$`Missing Observations`),
`Observations Removed` = sum(missing_kable$`Observations Removed))
Only `r scales::percent(sum(missing_kable$`Observations Removed`)/obs)`
scales::percent(sum(missing_kable$'Observations Removed')/obs)
number(obs, big.mark = ',')
scales::number(obs, big.mark = ',')
library(tidyverse)
source('../Data_Munging/FACES_fns.R')
theme_set(theme_bw())
faces <- read_csv("../../Data/cleaned_FACES_data.csv")
faces_tbl <- faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question))) %>%
ungroup() %>%
# Deselect participant id
select(-`Participant #`) %>%
group_by(Group, Time, Survey, Total_Questions) %>%
# Summarise only the responses
summarise_at('Total_Score',
.funs = list('mean' = mean, 'med' = median,
'rsd' = function(x, ...) sd(x, ...)/mean(x, ...)),
na.rm = T) %>%
ungroup() %>%
# Taking the columns generated by the summary function
pivot_longer(ends_with('mean') | ends_with('med') | ends_with('rsd'),
names_to = 'Category', values_to = 'Response') %>%
# Parsing out the column headers
# separate(Category_Summary, into = c('Category', 'Summary'), sep = "_") %>%
mutate(#Category = str_replace(Category,'[:digit:]', '') %>%
#           str_replace('[:digit:]', '')  %>%
#           str_trim(side = 'both'),
Category = factor(Category),
# Summary  = str_trim(Summary, side = 'both'),
# Summary  = factor(Summary),
Group    = factor(Group),
Time     = factor(Time, levels = c('Pre', 'Post')))
faces_tbl %>%
filter(Category == 'mean') %>%
ggplot() +
geom_col(aes(x = Category, y = Response, fill = Time), color = 'black', position = 'dodge') +
facet_grid(Survey~Group, scales = 'free_y') +
labs(title = 'Mean Response per Group x Survey',
x = '',
y = 'Mean of Response',
caption = 'Mean calculated from all participants
from a sum of their responses (1-5) score.
Only individuals in the  same Group + Survey + Time were averaged')
ggsave(filename = 'mean_comp.png', width = 9, height = 16, units = 'in')
faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question))) %>%
ungroup() %>%
mutate(Time     = factor(Time, levels = c('Pre', 'Post')),
Group    = factor(Group),
Survey   = factor(Survey)) %>%
ggplot() +
geom_boxplot(aes(x = Time, y = Total_Score, fill = Time), position = 'dodge') +
facet_grid(Survey~Group, scales = 'free_y') +
labs(title = 'Distribution of Responses per Group x Survey',
x = '',
y = 'Response Score',
caption = 'Response Score is a sum of all responses (1-5)
from a Survey + Group + Time for a single participant.')
ggsave(filename = 'total_comp.png', width = 9, height = 16, units = 'in')
faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question))) %>%
ungroup() %>%
mutate(Time     = factor(Time, levels = c('Pre', 'Post')),
Group    = factor(Group),
Survey   = factor(Survey)) %>%
pivot_wider(id_cols = c('Participant #', 'Group', 'Survey'),
names_from = 'Time',
values_from = 'Total_Score') %>%
mutate(Diff_Pct = (Post - Pre)/Pre) %>%
ggplot() +
geom_boxplot(aes(x = Group, y = Diff_Pct, fill = Group)) +
facet_wrap(Survey~., scales = 'free_y') +
labs(title = 'Distribution of Differences between Pre and Post Total Scores',
x = '',
y = 'Percent Difference',
caption = 'Calculation: Post - Pre %Difference
in response score per Participant + Survey + Group.') +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
breaks = scales::pretty_breaks(7)) +
theme(text = element_text(size = 16))
ggsave(filename = 'post_vs_pre.png', width = 16, height = 9, units = 'in')
faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question))) %>%
ungroup() %>%
mutate(Time     = factor(Time, levels = c('Pre', 'Post')),
Group    = factor(Group),
Survey   = factor(Survey)) %>%
pivot_wider(id_cols = c('Participant #', 'Group', 'Survey'),
names_from = 'Time',
values_from = 'Total_Score') %>%
mutate(Diff_Pct = (Post - Pre)/Pre,
Diff = (Post - Pre)) %>%
ggplot() +
geom_boxplot(aes(x = Group, y = Diff, fill = Group)) +
facet_wrap(Survey~., scales = 'free_y') +
labs(title = 'Distribution of Differences between Pre and Post Total Scores',
x = '',
y = 'Percent Difference',
caption = 'Calculation: Post - Pre %Difference
in response score per Participant + Survey + Group.') +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
breaks = scales::pretty_breaks(7)) +
theme(text = element_text(size = 16))
ggsave(filename = 'post_vs_pre.png', width = 16, height = 9, units = 'in')
faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question))) %>%
ungroup() %>%
mutate(Time     = factor(Time, levels = c('Pre', 'Post')),
Group    = factor(Group),
Survey   = factor(Survey)) %>%
pivot_wider(id_cols = c('Participant #', 'Group', 'Survey'),
names_from = 'Time',
values_from = 'Total_Score') %>%
mutate(Diff_Pct = (Post - Pre)/Pre,
Diff = (Post - Pre)) %>%
ggplot() +
geom_boxplot(aes(x = Group, y = Diff, fill = Group)) +
facet_wrap(Survey~., scales = 'free_y') +
labs(title = 'Distribution of Differences between Pre and Post Total Scores',
x = '',
y = 'Percent Difference',
caption = 'Calculation: Post - Pre %Difference
in response score per Participant + Survey + Group.') +
scale_y_continuous(labels = scales::percent_format(accuracy = 1),
breaks = scales::pretty_breaks(7)) +
theme(text = element_text(size = 17))
ggsave(filename = 'post_vs_pre.png', width = 16, height = 9, units = 'in')
faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question))) %>%
ungroup() %>%
mutate(Time     = factor(Time, levels = c('Pre', 'Post')),
Group    = factor(Group),
Survey   = factor(Survey)) %>%
pivot_wider(id_cols = c('Participant #', 'Group', 'Survey'),
names_from = 'Time',
values_from = 'Total_Score') %>%
mutate(Diff_Pct = (Post - Pre)/Pre,
Diff = (Post - Pre)) %>%
ggplot() +
geom_boxplot(aes(x = Group, y = Diff, fill = Group)) +
facet_wrap(Survey~., scales = 'free_y') +
labs(title = 'Distribution of Differences between Pre and Post Total Scores',
x = '',
y = 'Percent Difference',
caption = 'Calculation: Post - Pre %Difference
in response score per Participant + Survey + Group.') +
scale_y_continuous(#labels = scales::percent_format(accuracy = 1),
breaks = scales::pretty_breaks(7)) +
theme(text = element_text(size = 17))
ggsave(filename = 'post_vs_pre.png', width = 16, height = 9, units = 'in')
faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question))) %>%
ungroup() %>%
mutate(Time     = factor(Time, levels = c('Pre', 'Post')),
Group    = factor(Group),
Survey   = factor(Survey)) %>%
pivot_wider(id_cols = c('Participant #', 'Group', 'Survey'),
names_from = 'Time',
values_from = 'Total_Score') %>%
mutate(Diff_Pct = (Post - Pre)/Pre,
Diff = (Post - Pre)) %>%
ggplot() +
geom_boxplot(aes(x = Group, y = Diff, fill = Group)) +
facet_wrap(Survey~., scales = 'free_y') +
labs(title = 'Distribution of Differences between Pre and Post Total Scores',
x = '',
y = 'Percent Difference',
caption = 'Calculation: Post - Pre Difference
in response score per Participant + Survey + Group.') +
scale_y_continuous(#labels = scales::percent_format(accuracy = 1),
breaks = scales::pretty_breaks(7)) +
theme(text = element_text(size = 17))
ggsave(filename = 'post_vs_pre.png', width = 16, height = 9, units = 'in')
faces %>%
mutate(Survey = factor(Survey)) %>%
group_by(`Participant #`, Time, Group, Survey) %>%
summarise(Total_Score = sum(Response),
Total_Questions = length(unique(Question))) %>%
ungroup() %>%
mutate(Time     = factor(Time, levels = c('Pre', 'Post')),
Group    = factor(Group),
Survey   = factor(Survey)) %>%
pivot_wider(id_cols = c('Participant #', 'Group', 'Survey'),
names_from = 'Time',
values_from = 'Total_Score') %>%
mutate(Diff_Pct = (Post - Pre)/Pre,
Diff = (Post - Pre)) %>%
ggplot() +
geom_boxplot(aes(x = Group, y = Diff, fill = Group)) +
facet_wrap(Survey~., scales = 'free_y') +
labs(title = 'Distribution of Differences between Pre and Post Total Scores',
x = '',
y = 'Difference',
caption = 'Calculation: Post - Pre Difference
in response score per Participant + Survey + Group.') +
scale_y_continuous(#labels = scales::percent_format(accuracy = 1),
breaks = scales::pretty_breaks(7)) +
theme(text = element_text(size = 17))
ggsave(filename = 'post_vs_pre.png', width = 16, height = 9, units = 'in')
