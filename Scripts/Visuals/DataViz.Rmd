---
title: "Data visualizations"
author: "Joseph Oliveira"
date: "6/13/2020"
output: pdf_document
---

# Visualizing the FACES data

```{r message=FALSE, warning=FALSE}
library(tidyverse)
source('../Data_Munging/FACES_fns.R')
theme_set(theme_bw())
```

In the chunk below, I summarise the response from the participants. The mean and median are measures of centrality. The RSD is a measure of consistency.

The columns generated by the summary function are then transposed into a `Value` column and the relative column header, group value, time value are copied into the row of the transposed column.

The column headers were then parsed out into the question category and the applied summary statistic. Then some minor formatting was applied. 

Editing saved to `faces_tbl`. 

```{r message=FALSE, warning=FALSE}
faces <- format_FACES(path = '../../Data/FACES_data_Spring_2019_AllData.csv')

faces_tbl <- faces %>% 
  
  # Deselect participant id
  select(-`Participant #`) %>%
  group_by(Time, Group) %>%
  
  # Summarise only the responses
  summarise_if(is_numeric, 
               .funs = list('mean' = mean, 'med' = median, 
                            'rsd' = function(x, ...) sd(x, ...)/mean(x, ...)), 
               na.rm = T) %>%
  ungroup() %>%
  
  # Taking the columns generated by the summary function
  pivot_longer(ends_with('mean') | ends_with('med') | ends_with('rsd'),
               names_to = 'Category_Summary', values_to = 'Response') %>%
  
  # Parsing out the column headers
  separate(Category_Summary, into = c('Category', 'Summary'), sep = "_") %>%
  mutate(Category = str_replace(Category,'[:digit:]', '') %>% 
                    str_replace('[:digit:]', '')  %>% 
                    str_trim(side = 'both'),
         
         Category = factor(Category),
         Summary  = str_trim(Summary, side = 'both'),
         Summary  = factor(Summary),
         Group    = factor(Group),
         Time     = factor(Time, levels = c('Pre', 'Post')))
  
```


Using the new tbl to generate some visualizations.

```{r}
faces_tbl %>%
  filter(Summary == 'mean') %>%
  ggplot() +
  geom_boxplot(aes(x = Category, y = Response, fill = Group)) +
  facet_wrap(Category~Time, scales = 'free_x') +
  labs(title = 'Boxplot of Mean Response per Question Category')
ggsave(filename = 'BP_mean.png', width = 16, height = 9, units = 'in')
```

```{r}
faces_tbl %>%
  filter(Summary == 'med') %>%
  ggplot() +
  geom_boxplot(aes(x = Category, y = Response, fill = Group)) +
  facet_wrap(Category~Time, scales = 'free_x') +
  labs(title = 'Boxplot of Median Response per Question Category')
ggsave(filename = 'BP_med.png', width = 16, height = 9, units = 'in')
```

```{r}
faces_tbl %>%
  filter(Summary == 'rsd') %>%
  ggplot() +
  geom_boxplot(aes(x = Category, y = Response, fill = Group)) +
  facet_wrap(Category~Time, scales = 'free_x') +
  labs(title = 'Boxplot of RSD Response per Question Category')
ggsave(filename = 'BP_rsd.png', width = 16, height = 9, units = 'in')
```

Sample Size

```{r}

```

